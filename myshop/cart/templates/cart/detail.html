{% extends "shop/base.html" %}
{% load static %}

{% block title %}<title>Корзина</title>{% endblock %}
{% block description %}<meta name="description" content="Содержимое корзины." />{% endblock %}
{% block keywords %}
<meta name="keywords" content="корзина, содержимое корзины" />
{% endblock %}
{% block content %}
    <div id="cart">
        <h2>Корзина</h2>
                <table>
                    <tr>
                        <td colspan="8" id="cart_top"></td>
                    </tr>
                    <tr>
                        <td class="cart_left"></td>
                        <td colspan="2">Товар</td>
                        <td>Количество</td>
                        <td>Удалить</td>
                        <td>Цена за 1 шт.</td>
                        <td>Стоимость</td>
                        <td></td>
                        <td class="cart_right"></td>
                    </tr>
                    {% for item in cart %}
                        {% with product=item.product %}
                    <tr>
                            <td class="cart_left"></td>
                            <td colspan="6">
                                <hr />
                            </td>
                            <td class="cart_right"></td>
                    </tr>
                    <tr class="cart_row">
                            <td class="cart_left"></td>
                            <td class="img">
                                <a href="{{ product.get_absolute_url }}">
                                <img src="{{ product.image.url }}" alt="{{ product.name }}" />
                                </a>
                            </td>
                            <td class="name">{{ product.name }}</td>
                            <td class="name">{{ item.quantity }}</td>
                            <td>{{ product.name }}</td>
                            <td>
                        <form action="{% url 'cart:cart_add' product.id %}" method="post">
                        {{ item.update_quantity_form.quantity }}
                        {{ item.update_quantity_form.update }}
                         <input type="submit" value="Изменить">
                        {% csrf_token %}
                        </form>
                        </td>
                            <td><a href="{% url 'cart:cart_remove' product.id %}">Удалить</a></td>
                            <td class="num">${{ item.price }}</td>
                            <td class="num">${{ item.total_price }}</td>
                    </tr>
                    {% endwith %}
                    {% endfor %}
                        <tr>
                            <td class="bold">{{ cart.get_total_price }} руб.</td>
                            <td>
                                <a href="#" class="link_delete"> Продолжить покупки</a>
                            </td>
                            <td class="cart_right"></td>
                        </tr>

                    <tr id="discount">
                        <td class="cart_left"></td>
                        <td colspan="6">
                            <table>
                                <tr>
                                    <td>Введите номер купона со скидкой<br /><span>(если есть)</span></td>
                                    <td>
                                        <input type="text" name="discount" value="{{ discount }}" />
                                    </td>
                                    <td>

                                        <input type="image" src="{% static 'images/cart_discount.png' %}" alt="Получить скидку" onmouseover="this.src='{% static 'images/cart_discount_active.png' %}'" onmouseout="this.src='{% static 'images/cart_discount.png' %}'" />
                                    </td>
                                </tr>
                            </table>
                        </td>
                        <td class="cart_right"></td>
                    </tr>
                    <tr id="summa">
                        <td class="cart_left"></td>
                        <td colspan="6">
                            <p>Итого # со скидкой: <span> руб.</span></p>
                        </td>
                        <td class="cart_right"></td>
                    </tr>
                    <tr>
                        <td class="cart_left"></td>
                        <td colspan="2">
                            <div class="left">
                                <input type="image" src="{% static 'images/cart_recalc.png' %}" alt="Пересчитать" onmouseover="this.src='{% static 'images/cart_recalc_active.png' %}'" onmouseout="this.src='{% static 'images/cart_recalc.png' %}'" />
                            </div>
                        </td>
                        <td colspan="4">
                            <div class="right">
                                <a href="#">
                                    <img src="{% static 'images/cart_order.png' %}" alt="Оформить заказ" onmouseover="this.src='{% static 'images/cart_order_active.png' %}'" onmouseout="this.src='{% static 'images/cart_order.png' %}'" />
                                </a>
                            </div>
                        </td>
                        <td class="cart_right"></td>
                    </tr>
                    <tr>
                        <td colspan="8" id="cart_bottom"></td>
                    </tr>
                </table>


            <p>Корзина пуста</p>

    </div>
{% endblock %}